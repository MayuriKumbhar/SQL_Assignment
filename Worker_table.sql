--#1 Create a new Database
CREATE DATABASE Workers;

--#2
CREATE TABLE Worker (
    WORKER_ID INT IDENTITY PRIMARY KEY,
    FIRST_NAME VARCHAR(50),
    LAST_NAME VARCHAR(50),
    SALARY FLOAT,
    JOINING_DATE DATETIME,
    DEPARTMENT_ID INT
);

SELECT WORKER_ID, FIRST_NAME, LAST_NAME, SALARY, JOINING_DATE, DEPARTMENT_ID
FROM Worker;

--#3
INSERT INTO Worker VALUES('Monika','Arora',100000,'02/20/14 9:00',1);
INSERT INTO Worker VALUES('Niharika','Verma',80000,'06/11/14 9:00',2);
INSERT INTO Worker VALUES('Vishal','Singhal',300000,'02/20/14 9:00',1);
INSERT INTO Worker VALUES('Amitabh','Singh',500000,'02/20/14 9:00',2);
INSERT INTO Worker VALUES('Vivek','Bhati',500000,'06/11/14 9:00',2);
INSERT INTO Worker VALUES('Vipul','Diwan',200000,'06/11/14 9:00',3);
INSERT INTO Worker VALUES('Satish','Kumar',75000,'01/20/14 9:00',3);
INSERT INTO Worker VALUES('Geetika','Chauhan',90000,'04/11/14 9:00',2);


--#4
ALTER TABLE Worker ADD CONSTRAINT DF_Worker DEFAULT GETDATE() FOR JOINING_DATE 


--#5
UPDATE Worker
 set SALARY=SALARY + 20000
  WHERE WORK_ID=7;
UPDATE Worker
 set SALARY=SALARY +20000
  WHERE WORK_ID=8;


--#6
SELECT WORKER_ID,FIRST_NAME,LAST_NAME,SALARY,JOINING_DATE from Worker ORDER BY FIRST_NAME;


--#7
SELECT WORKER_ID,FIRST_NAME,LAST_NAME,SALARY,JOINING_DATE from Worker ORDER BY FIRST_NAME, SALARY;


--#8
SELECT * FROM Worker WHERE SALARY>300000;


--#9
SELECT WORKER_ID,FIRST_NAME,LAST_NAME,SALARY,JOINING_DATE from Worker WHERE JOINING_DATE > '2014-05-31';


--#10
CREATE TABLE Department(
    FOREIGN KEY ( DEPARTMENT_ID)
	REFERENCES Worker(WORKER_ID ),
    Department_Name VARCHAR(25)    
);

 CREATE TABLE Department(
    DEPARTMENT_ID INT,
    FOREIGN KEY (DEPARTMENT_ID ) 
    REFERENCES Worker( WORKER_ID )
    ON DELETE CASCADE,
    Department_Name VARCHAR(25)  
    );

    INSERT INTo Department(DEPARTMENT_ID, Department_Name)  VALUES
    (1, 'HR' ),
    (2, 'Admin'),
    (3, 'Account')

SELECT * FROM Department;

SELECT  *
FROM Worker
FULL JOIN Department
ON Worker.DEPARTMENT_ID = Department.DEPARTMENT_ID;

--#11
CREATE TABLE Bonus (
	WORKER_REF_ID INT,
    BONUS_DATE VARCHAR(50),
	BONUS_AMOUNT INT,
	FOREIGN KEY (WORKER_REF_ID)
		REFERENCES Worker(WORKER_ID)
        ON DELETE CASCADE
);

INSERT INTO Bonus 
	(WORKER_REF_ID, BONUS_DATE,  BONUS_AMOUNT) VALUES
		(1, '20/02/2016  12:00:00 AM', 5000 ),
		(2, '11/06/2016  12:00:00 AM', 3000 ),
		(3, '20/02/2016  12:00:00 AM', 4000),
		(1, '20/02/2016  12:00:00 AM', 4500 ),
		(2, '11/06/2016  12:00:00 AM', 3500 );

SELECT * FROM Bonus;

select
    First_Name, Salary, BONUS_AMOUNT,
    (Salary + BONUS_AMOUNT) as "Total_salary" 
from Worker, Bonus;

--#12
CREATE TABLE Title (
	WORKER_REF_ID INT,
	WORKER_TITLE CHAR(25),
	AFFECTED_FROM VARCHAR(50),
	FOREIGN KEY (WORKER_REF_ID)
		REFERENCES Worker(WORKER_ID)
        ON DELETE CASCADE
);


INSERT INTO Title 
	(WORKER_REF_ID, WORKER_TITLE, AFFECTED_FROM) VALUES
 (1, 'Manager', '20/02/2016  12:00:00 AM'),
 (2, 'Executive', '11/06/2016  12:00:00 AM'),
 (8, 'Executive', '11/06/2016  12:00:00 AM'),
 (5, 'Manager', '11/06/2016  12:00:00 AM'),
 (4, 'Asst. Manager', '11/06/2016  12:00:00 AM'),
 (7, 'Executive', '11/06/2016  12:00:00 AM'),
 (6, 'Lead', '11/06/2016  12:00:00 AM'),
 (3, 'Lead', '11/06/2016  12:00:00 AM');

 SELECT * FROM Title;

SELECT * FROM Worker
UNION ALL
SELECT * FROM Title

--#13
SELECT DEPARTMENT_ID, SUM(Salary) FROM Worker GROUP BY DEPARTMENT_ID;

--#14
SELECT DEPARTMENT_ID, SUM(Salary) FROM Worker GROUP BY DEPARTMENT_ID
WHERE SUM(Salary)>500000;










